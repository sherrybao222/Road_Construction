---
title: "final_statistics"
author: "sherry"
date: "2023-06-19"
output: html_document
---
# setup
## load
```{r}
rm(list=ls())

knitr::opts_chunk$set(echo = FALSE)

library(DHARMa)
library(rcompanion)

pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
```
# Undo Initiation
## Error correction efficiency
### Make errors at the beginning
#### Basic condition (supp)
```{r}
load(file.path(save_folder, 'model_error_step_basic_condition.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_error, n = 1000, plot = F)
plot(simulationOutput)
```
#### Undo condition
```{r}
load(file.path(save_folder, 'model_error_step_undo_condition.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_error, n = 1000, plot = F)
plot(simulationOutput)
```
#### Given undo (supp)
```{r}
load(file.path(save_folder, 'model_error_step_given_undo.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_error, n = 1000, plot = F)
plot(simulationOutput)
```
### Undo at the end
#### Across step
```{r}
load(file.path(save_folder, 'model_undo_step.RData'))
load(file.path(save_folder, 'model2_undo_step.RData'))
compareGLM(model_undo, model_undo2)
```

```{r}
load(file.path(save_folder, 'model_undo_step.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo, n = 1000, plot = F)
plot(simulationOutput)
```
### Sequential - error magnitude
#### Probability
```{r}
load(file.path(save_folder, 'model_undo_error_magnitude.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo, n = 1000, plot = F)
plot(simulationOutput)
```
```{r}

```

```{r}
load(file.path(save_folder, 'model_sequential_undo_error_magnitude.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo, n = 1000, plot = F)
plot(simulationOutput)
```
```{r}
load(file.path(save_folder, 'model_single_undo_error_magnitude.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo, n = 1000, plot = F)
plot(simulationOutput)
```
#### Proportion
```{r}
load(file.path(save_folder, 'model_prop_single_undo_error_magnitude.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo, n = 1000, plot = F, re.form = NULL) # 
plot(simulationOutput)

testUniformity(simulationOutput) 
testQuantiles(simulationOutput)
```
## Possible cues for error correction
### Achievd score in a puzzle
```{r}
load(file.path(save_folder, 'model_undo_optimal_mas_TT.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo, n = 1000, plot = F, re.form = NULL)
plot(simulationOutput)

plot(simulationOutput, form = state_df$TT)
testZeroInflation(simulationOutput)
testQuantiles(simulationOutput)
```
### Remaining budget
```{r}
load(file.path(save_folder, 'model_undo_optimal_mas_TT_budget.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo, n = 1000, plot = F, re.form = NULL) #, re.form = NULL
plot(simulationOutput)

plot(simulationOutput, form = state_df$TT)
testZeroInflation(simulationOutput)
testQuantiles(simulationOutput)
```
### Uncertainty
#### First-move RT
```{r}
load(file.path(save_folder, 'model_undo_rt1.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)

testZeroInflation(simulationOutput)
testQuantiles(simulationOutput)
```

# Undo Completion
## what predicts the undo terminal
```{r}
load(file.path(save_folder, 'model_undo_right_error_and_cumulative.RData'))
simulationOutput <- simulateResiduals(fittedModel = model_undo_right, n = 2000, plot = F) #, re.form = NULL
plot(simulationOutput)

testZeroInflation(simulationOutput)
testQuantiles(simulationOutput)
```

