RT_terminal <- RT_terminal[RT_terminal$RT<=30,]
model_RT <- lme4::glmer(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma("inverse"),
control = glmerControl(optimizer = "nloptwrap"))
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
RT_terminal <- RT_terminal[RT_terminal$RT<=30,]
model_RT <- lme4::lmer(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma("inverse"),
control = glmerControl(optimizer = "nloptwrap"))
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
RT_terminal$RT = RT_terminal$RT/1000
RT_terminal <- RT_terminal[RT_terminal$RT<=30,]
model_RT <- glmmTMB(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma("inverse"))
model_RT <- glmmTMB(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma(link = "inverse"))
installed.packages() |> as.data.frame() |> subset(Package=="Matrix", select = c(LibPath, Version))
install.packages("~/Downloads/Matrix_1.6-2.tar.gz", repos = NULL, type = "source")
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
RT_terminal$RT = RT_terminal$RT/1000
model_RT <- glmmTMB(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma(link = "inverse"))
installed.packages() |> as.data.frame() |> subset(Package=="Matrix", select = c(LibPath, Version))
model_RT <- lme4::glmer(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma(link = "inverse"))
install.packages("~/Downloads/Matrix_1.6-1.tar.gz", repos = NULL, type = "source")
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
RT_terminal$RT = RT_terminal$RT/1000
model_RT <- lme4::glmer(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma(link = "inverse"))
model_RT <- glmmTMB(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma(link = "inverse"))
install.packages("~/Downloads/Matrix_1.6-1.1.tar.gz", repos = NULL, type = "source")
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
RT_terminal$RT = RT_terminal$RT/1000
model_RT <- glmmTMB(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = Gamma(link = "inverse"))
model_RT <- glmmTMB(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = inverse.gaussian())
model_RT <- glmmTMB(RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = inverse.gaussian(link = "1/mu^2"))
model_RT <- glmmTMB(
RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = inverse.gaussian(link = "1/mu^2"))
model_RT <- lme4::glmer(
RT ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal,
family = inverse.gaussian(link = "1/mu^2"))
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lmerTest::lmer(RT_log ~  1 + currNumCities * undo + (1 |subjects) + (1|puzzleID),
data = RT_nonterminal[RT_nonterminal$currNumCities>=1,])
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
model_RT <- lmerTest::lmer(RT_log ~  1 + currNumCities + undo + (1 |subjects) + (1|puzzleID),
data = RT_nonterminal[RT_nonterminal$currNumCities>=1,])
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
model_RT <- lme4::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lme4::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lme4::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lme4::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lme4::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
summary(RT_terminal$RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lme4::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lmerTest::lmer(RT_log ~  1 + currNumCities + undo + (1 |subjects) + (1|puzzleID),
data = RT_nonterminal[RT_nonterminal$currNumCities>=1,])
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
model_RT <- lme4::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lme4::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lmerTest::lmer(RT_log ~  1 + currNumCities + undo + (1 |subjects) + (1|puzzleID),
data = RT_nonterminal[RT_nonterminal$currNumCities>=1,])
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lmerTest::lmer(RT_log ~  1 + currNumCities + undo + (1 |subjects) + (1|puzzleID),
data = RT_nonterminal[RT_nonterminal$currNumCities>=1,])
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
summary(RT_nonterminal$RT)
model_RT <- lmerTest::lmer(
RT_log ~  1 + currNumCities + firstUndo + (1|subjects) + (1|puzzleID),
data = RT_terminal)
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lmerTest::lmer(RT_log ~  1 + currNumCities + undo + (1 |subjects) + (1|puzzleID),
data = RT_nonterminal[RT_nonterminal$currNumCities>=1,])
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
model_RT <- lmerTest::lmer(RT_log ~  1 + currNumCities + undo + (1 |subjects) + (1|puzzleID),
data = RT_nonterminal[RT_nonterminal$currNumCities>=1,])
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_RT <- lmerTest::lmer(RT_log ~  1 + currNumCities + undo + (1 |subjects) + (1|puzzleID),
data = RT_nonterminal[RT_nonterminal$currNumCities>=1,])
simulationOutput <- simulateResiduals(fittedModel = model_RT, n = 1000, plot = F) #, re.form = NULL
plot(simulationOutput)
summary(model_RT)
model_undo_terminal1 = lme4::glmer(firstUndo ~  1 + currNumCities + leftover_new + budget_change_new + within_reach_change_new + (1 |subjects)+(1|puzzleID) ,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal2 = lme4::glmer(firstUndo ~  1 + currNumCities + leftover_new  + budget_change_new + (1 |subjects)+(1|puzzleID) ,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal3 = lme4::glmer(firstUndo ~  1 + currNumCities + leftover_new  + within_reach_change_new + (1 |subjects)+(1|puzzleID) ,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal4 = lme4::glmer(firstUndo ~  1 + currNumCities + leftover_new  + (1 |subjects)+(1|puzzleID),
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
# ref: https://rstudio-pubs-static.s3.amazonaws.com/358672_09291d0b37ce43f08cf001cfd25c16c2.html#bic-in-lme4lmer
# interpretation for BF: https://en.wikipedia.org/wiki/Bayes_factor
BF_BIC_terminal12 = exp((BIC(model_undo_terminal1) - BIC(model_undo_terminal2))/2)
BF_BIC_terminal13 = exp((BIC(model_undo_terminal1) - BIC(model_undo_terminal3))/2)
print(BF_BIC_terminal12,BF_BIC_terminal13)
print(c(BF_BIC_terminal12,BF_BIC_terminal13))
# ref: https://rstudio-pubs-static.s3.amazonaws.com/358672_09291d0b37ce43f08cf001cfd25c16c2.html#bic-in-lme4lmer
# interpretation for BF: https://en.wikipedia.org/wiki/Bayes_factor
BF_BIC_terminal12 = exp((BIC(model_undo_terminal2) - BIC(model_undo_terminal1))/2)
BF_BIC_terminal23 = exp((BIC(model_undo_terminal2) - BIC(model_undo_terminal3))/2)
print(c(BF_BIC_terminal12,BF_BIC_terminal23))
BF_BIC_terminal24 = exp((BIC(model_undo_terminal2) - BIC(model_undo_terminal4))/2)
BF_BIC_terminal34 = exp((BIC(model_undo_terminal3) - BIC(model_undo_terminal4))/2)
print(c(BF_BIC_terminal24,BF_BIC_terminal34))
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
library(cAIC4)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
anocAIC(model_undo_terminal1, model_undo_terminal2, model_undo_terminal3, model_undo_terminal4)
model_undo_terminal1 = lme4::glmer(firstUndo ~  1 + currNumCities + leftover_new + budget_change_new + within_reach_change_new + (1 |subjects)+(1|puzzleID) ,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal2 = lme4::glmer(firstUndo ~  1 + currNumCities + leftover_new  + budget_change_new + (1 |subjects)+(1|puzzleID) ,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal3 = lme4::glmer(firstUndo ~  1 + currNumCities + leftover_new  + within_reach_change_new + (1 |subjects)+(1|puzzleID) ,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal4 = lme4::glmer(firstUndo ~  1 + currNumCities + leftover_new  + (1 |subjects)+(1|puzzleID),
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
anocAIC(model_undo_terminal1, model_undo_terminal2, model_undo_terminal3, model_undo_terminal4)
cAIC(model_undo_terminal1)
cAIC(model_undo_terminal1, analytic = FALSE)
model_undo_nonterminal1 = glm(firstUndo ~  1 + currNumCities + leftover_new + budget_change_new + within_reach_change_new,
data = undo_data[undo_data$checkEnd==0,], family = binomial(link="logit"))
model_undo_nonterminal2 = lme4::glmer(firstUndo ~  1 + budget_change_new + within_reach_change_new + (1 |subjects)+(1|puzzleID) ,
data = undo_data[undo_data$checkEnd==0,], family = binomial(link="logit"))
model_undo_terminal1 = glm(firstUndo ~  1 + currNumCities + leftover_new + budget_change_new + within_reach_change_new,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal2 = glm(firstUndo ~  1 + currNumCities + leftover_new  + budget_change_new,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal3 = glm(firstUndo ~  1 + currNumCities + leftover_new  + within_reach_change_new,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal4 = glm(firstUndo ~  1 + currNumCities + leftover_new,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
compareGLM(model_undo_terminal1,model_undo_terminal2,
model_undo_terminal3,model_undo_terminal4)
rm(list=ls())
knitr::opts_chunk$set(echo = FALSE)
library(lme4)
library(lmerTest)
library(DHARMa)
library(rcompanion)
library(glmmTMB)
library(cAIC4)
# library(BayesFactor)
pathToFolder <- "/Users/dbao/My_Drive/road_construction/data/2022_online/"
save_folder <- file.path(pathToFolder, 'stat_model/final/')
undo_data <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_undo_data.csv"))
RT_nonterminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_nonterminal.csv"))
RT_terminal <- read.csv(file.path(pathToFolder, "/R_analysis_data/statsdata_rt_terminal.csv"))
model_undo_terminal1 = glm(firstUndo ~  1 + currNumCities + leftover_new + budget_change_new + within_reach_change_new,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal2 = glm(firstUndo ~  1 + currNumCities + leftover_new  + budget_change_new,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal3 = glm(firstUndo ~  1 + currNumCities + leftover_new  + within_reach_change_new,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
model_undo_terminal4 = glm(firstUndo ~  1 + currNumCities + leftover_new,
data = undo_data[undo_data$checkEnd==1,], family = binomial(link="logit"))
compareGLM(model_undo_terminal1,model_undo_terminal2,
model_undo_terminal3,model_undo_terminal4)
simulationOutput <- simulateResiduals(fittedModel = model_undo_terminal3, n = 1000, plot = F, re.form = NULL) #
plot(simulationOutput)
model_undo_nonterminal1 = glm(firstUndo ~  1 + currNumCities + leftover_new + budget_change_new + within_reach_change_new,
data = undo_data[undo_data$checkEnd==0,], family = binomial(link="logit"))
model_undo_nonterminal2 = glm(firstUndo ~  1 + currNumCities + budget_change_new + within_reach_change_new,
data = undo_data[undo_data$checkEnd==0,], family = binomial(link="logit"))
model_undo_nonterminal3 = glm(firstUndo ~  1 + leftover_new + budget_change_new + within_reach_change_new,
data = undo_data[undo_data$checkEnd==0,], family = binomial(link="logit"))
model_undo_nonterminal4 = glm(firstUndo ~  1 + budget_change_new + within_reach_change_new ,
data = undo_data[undo_data$checkEnd==0,], family = binomial(link="logit"))
# BF_BIC_nonterminal = exp((BIC(model_undo_nonterminal2) - BIC(model_undo_nonterminal1))/2)
# print(BF_BIC_nonterminal)
compareGLM(model_undo_nonterminal1,model_undo_nonterminal2,
model_undo_nonterminal3,model_undo_nonterminal4)
summary(model_undo_nonterminal3)
BF_BIC_nonterminal = exp((BIC(model_undo_nonterminal2) - BIC(model_undo_nonterminal1))/2)
print(BF_BIC_nonterminal)
# compareGLM(model_undo_nonterminal1,model_undo_nonterminal2,
#            model_undo_nonterminal3,model_undo_nonterminal4)
BF_BIC_nonterminal = exp((BIC(model_undo_nonterminal4) - BIC(model_undo_nonterminal1))/2)
print(BF_BIC_nonterminal)
# compareGLM(model_undo_nonterminal1,model_undo_nonterminal2,
#            model_undo_nonterminal3,model_undo_nonterminal4)
simulationOutput <- simulateResiduals(fittedModel = model_undo_nonterminal2, n = 1000, plot = F, re.form = NULL) #
plot(simulationOutput)
result = compareGLM(model_undo_terminal1,model_undo_terminal2,
model_undo_terminal3,model_undo_terminal4)
View(result)
result = compareGLM(model_undo_terminal1,model_undo_terminal2,
model_undo_terminal3,model_undo_terminal4)
BF_BIC_nonterminal = exp((BIC(model_undo_nonterminal4) - BIC(model_undo_nonterminal1))/2)
print(BF_BIC_nonterminal)
# compareGLM(model_undo_nonterminal1,model_undo_nonterminal2,
#            model_undo_nonterminal3,model_undo_nonterminal4)
summary(model_undo_nonterminal4)
# BF_BIC_nonterminal = exp((BIC(model_undo_nonterminal4) - BIC(model_undo_nonterminal1))/2)
# print(BF_BIC_nonterminal)
compareGLM(model_undo_nonterminal1,model_undo_nonterminal2,
model_undo_nonterminal3,model_undo_nonterminal4)
summary(model_undo_nonterminal)
summary(model_undo_nonterminal3)
summary(model_undo_nonterminal1)
summary(model_undo_nonterminal3)
compareGLM(model_undo_terminal1,model_undo_terminal2,
model_undo_terminal3,model_undo_terminal4)
summary(model_undo_terminal3)
cor.test(undo_data[undo_data$checkEnd==0,"budget_change_new"],
undo_data[undo_data$checkEnd==0,"leftover_new"])
View(undo_data)
data_df = undo_data[(undo_data$checkEnd==0)&(undo_data$N_more>1),]
model_undo_nonterminal1 = glm(firstUndo ~  1 + currNumCities + leftover_new + budget_change_new + within_reach_change_new,
data = data_df, family = binomial(link="logit"))
model_undo_nonterminal2 = glm(firstUndo ~  1 + currNumCities + budget_change_new + within_reach_change_new,
data = data_df, family = binomial(link="logit"))
model_undo_nonterminal3 = glm(firstUndo ~  1 + leftover_new + budget_change_new + within_reach_change_new,
data = data_df, family = binomial(link="logit"))
model_undo_nonterminal4 = glm(firstUndo ~  1 + budget_change_new + within_reach_change_new ,
data = data_df, family = binomial(link="logit"))
# BF_BIC_nonterminal = exp((BIC(model_undo_nonterminal4) - BIC(model_undo_nonterminal1))/2)
# print(BF_BIC_nonterminal)
compareGLM(model_undo_nonterminal1,model_undo_nonterminal2,
model_undo_nonterminal3,model_undo_nonterminal4)
summary(model_undo_nonterminal3)
cor.test(undo_data[undo_data$checkEnd==0,"budget_change_new"],
undo_data[undo_data$checkEnd==0,"leftover_new"])
summary(model_undo_nonterminal4)
